function cart(){var e={templateUrl:"/views/cart.html",restrict:"E",controller:cartCtrl,controllerAs:"cart",bindToController:{developers:"="}};return e}function cartCtrl(e,r,t){function n(){l.developersCart.forEach(function(e){l.developersCart.$remove(e)}),l.developers.forEach(function(e){e.isAdded=!1})}function o(e){var r=_.find(l.developers,"login",e.login);r&&(r.isAdded=!1),l.developersCart.$remove(e)}function a(){l.finishOrder=!0}function i(){l.sum=0,l.developersCart.forEach(function(e){null!=e.hour&&(l.sum=l.sum+e.hour*e.price)})}var l=this;l.developersCart=r,l.clearAll=n,l.remove=o,l.submit=a,l.sumSubtotal=i,l.developersCart.$watch(i)}function devList(){var e={templateUrl:"/views/devList.html",restrict:"E",controller:devListCtrl,controllerAs:"devList",bindToController:{developers:"=",organizationNotFound:"=",searchDevelopers:"=",pages:"="}};return e}function devListCtrl(e,r,t){function n(e){e.get().then(function(r){e=angular.extend(e,r.data);var t=e.plain(),n=(5*e.followers+2*e.public_repos+e.public_gists)/30;5>n&&(n=5),t.price=n,e.price=n,t.hour=1,t.isAdded=!0,e.isAdded=!0,o.developersCart.$add(t)})}var o=this;o.developersCart=r,o.addToCart=n}function payment(){var e={templateUrl:"/views/payment.html",restrict:"E",controller:paymentCtrl,controllerAs:"payment",bindToController:{sum:"=",finishOrder:"="}};return e}function paymentCtrl(e,r,t,n){function o(){c.finishOrder=!1}function a(){n.location.reload(),c.developersCart.forEach(function(e){c.developersCart.$remove(e)})}function i(){c.orderSuccess=!0}function l(){c.sum=0,c.developersCart.forEach(function(e){null!=e.hour&&(c.sum=c.sum+e.hour*e.price)})}function s(){"SHIPTO"===c.discountCode?(c.discount=.3*c.sum,c.errorOnValidate=!1,c.hideDiscountForm=!0):c.errorOnValidate=!0}var c=this;c.developersCart=r,c.errorOnValidate=!1,c.orderSuccess=!1,c.back=o,c.shopAgain=a,c.shopDevelopers=i,c.sumSubtotal=l,c.validate=s,c.developersCart.$watch(l)}function search(){var e={templateUrl:"/views/search.html",restrict:"E",controller:searchCtrl,controllerAs:"search",bindToController:!0};return e}function searchCtrl(e,r,t){function n(){function e(e){i.organization=e.data,i.organizationNotFound=!1,o(1)}function r(){i.organizationNotFound=!0}var n=t.get(i.organizationName);n.then(e,r)}function o(e){i.organization.getList("members",{per_page:10,page:e}).then(function(e){i.developers=e.data,i.pages=a(e.headers("link")),i.developers.forEach(function(e){_.find(i.developersCart,"login",e.login)&&(e.isAdded=!0)})})}function a(e){if(0==e.length)throw new Error("input must not be of zero length");var r=e.split(","),t={};return _.each(r,function(e){var r=e.split(";");if(2!=r.length)throw new Error("section could not be split on ';'");var n=r[0].replace(/<(.*)>/,"$1").trim(),o=r[1].replace(/rel="(.*)"/,"$1").trim(),a=unescape(n.replace(new RegExp("^(?:.*[&\\?]"+escape("page").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));t[o]=a}),t}var i=this;i.searchOrganization=n,i.searchDevelopers=o,i.developersCart=r}!function(){"use strict";angular.module("app",["firebase","ngMessages","restangular"])}(),angular.module("app").directive("cart",cart),cartCtrl.$inject=["$scope","Developers","Organization"],angular.module("app").directive("devList",devList),devListCtrl.$inject=["$scope","Developers","Organization"],function(){"use strict";function e(e){var r=new Firebase("https://devshop.firebaseio.com/developers");return e(r)}angular.module("app").factory("Developers",e),e.$inject=["$firebaseArray"]}(),function(){"use strict";function e(e){return e.withConfig(function(e){e.setBaseUrl("https://api.github.com").setRestangularFields({id:"name",selfLink:"url"}).setFullResponse(!0)}).all("orgs")}angular.module("app").factory("Organization",e),e.$inject=["Restangular"]}(),angular.module("app").directive("payment",payment),paymentCtrl.$inject=["$scope","Developers","Organization","$window"],angular.module("app").directive("search",search),searchCtrl.$inject=["$scope","Developers","Organization"];